<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Nostr Market Directory</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{--bg:#0a0a0a;--bg2:#111;--bg3:#1a1a1a;--border:#2a2a2a;--accent:#f5a623;--text:#e8e8e8;--muted:#666;--card:#141414;}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Syne',sans-serif;min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(245,166,35,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(245,166,35,0.03) 1px,transparent 1px);background-size:60px 60px;pointer-events:none;z-index:0;}
header{z-index:10;border-bottom:1px solid var(--border);padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:70px;background:rgba(10,10,10,0.95);backdrop-filter:blur(10px);position:sticky;top:0;}
.logo{display:flex;align-items:center;gap:12px;}
.logo-icon{width:36px;height:36px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;}
.logo-text{font-size:18px;font-weight:800;letter-spacing:-.5px;}
.logo-text span{color:var(--accent);}
nav{display:flex;gap:28px;align-items:center;}
nav a{color:var(--muted);text-decoration:none;font-size:14px;font-weight:600;transition:color .2s;}
nav a:hover{color:var(--text);}
.btn{background:var(--accent);color:#000;border:none;padding:8px 20px;border-radius:6px;font-family:'Syne',sans-serif;font-weight:700;font-size:13px;cursor:pointer;transition:opacity .2s;}
.btn:hover{opacity:.85;}
.hero{position:relative;z-index:1;padding:70px 40px 50px;max-width:1200px;margin:0 auto;}
.hero-tag{display:inline-flex;align-items:center;gap:8px;background:rgba(245,166,35,.1);border:1px solid rgba(245,166,35,.3);border-radius:100px;padding:4px 14px;font-size:12px;font-family:'Space Mono',monospace;color:var(--accent);margin-bottom:24px;}
.hero-tag::before{content:'';width:6px;height:6px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
h1{font-size:clamp(34px,5vw,64px);font-weight:800;line-height:1.05;letter-spacing:-2px;margin-bottom:18px;}
h1 em{font-style:normal;color:var(--accent);}
.hero-sub{font-size:16px;color:var(--muted);max-width:500px;line-height:1.6;margin-bottom:36px;font-weight:400;}
.stats{display:flex;gap:36px;flex-wrap:wrap;}
.stat-num{font-size:28px;font-weight:800;color:var(--accent);font-family:'Space Mono',monospace;}
.stat-label{font-size:11px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;}
.mode-wrap{position:relative;z-index:1;padding:36px 40px 0;max-width:1200px;margin:0 auto;}
.mode-sw{display:inline-flex;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:4px;gap:4px;}
.mbtn{padding:10px 22px;border-radius:9px;border:none;background:transparent;color:var(--muted);font-family:'Syne',sans-serif;font-weight:700;font-size:13px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:8px;}
.mbtn.active{background:var(--accent);color:#000;}
.mcnt{background:rgba(0,0,0,.2);border-radius:100px;padding:1px 7px;font-size:11px;font-family:'Space Mono',monospace;}
.mbtn:not(.active) .mcnt{background:var(--bg3);color:var(--muted);}
.filters{position:relative;z-index:1;padding:18px 40px 28px;max-width:1200px;margin:0 auto;}
.search{display:flex;align-items:center;gap:12px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 18px;margin-bottom:14px;transition:border-color .2s;}
.search:focus-within{border-color:var(--accent);}
.search input{background:none;border:none;outline:none;color:var(--text);font-family:'Syne',sans-serif;font-size:15px;width:100%;}
.search input::placeholder{color:var(--muted);}
.frow{display:flex;gap:8px;flex-wrap:wrap;align-items:center;}
.flbl{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;}
.chip{padding:6px 13px;border-radius:100px;border:1px solid var(--border);background:var(--card);color:var(--muted);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;font-family:'Syne',sans-serif;}
.chip:hover{border-color:var(--accent);color:var(--accent);}
.chip.active{background:var(--accent);border-color:var(--accent);color:#000;}
.divider{width:1px;height:20px;background:var(--border);}
.main{position:relative;z-index:1;padding:0 40px 80px;max-width:1200px;margin:0 auto;}
.sec-hdr{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;}
.sec-lbl{font-size:12px;font-family:'Space Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;}
.sort{background:var(--card);border:1px solid var(--border);color:var(--muted);font-family:'Syne',sans-serif;font-size:13px;padding:6px 12px;border-radius:6px;cursor:pointer;outline:none;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(310px,1fr));gap:16px;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.badge-v{display:inline-flex;align-items:center;gap:3px;font-size:10px;font-family:'Space Mono',monospace;font-weight:700;color:#7fb3d3;}
.badge-f{display:inline-flex;align-items:center;gap:3px;font-size:10px;font-family:'Space Mono',monospace;font-weight:700;color:#c9922a;}
.bdgs{display:flex;gap:8px;margin-bottom:8px;}
.exp{font-size:10px;font-family:'Space Mono',monospace;color:var(--muted);}
.exp.soon{color:#e67e22;}
.rpt{background:none;border:none;cursor:pointer;font-size:11px;font-family:'Space Mono',monospace;color:#333;transition:color .2s;padding:0;}
.rpt:hover{color:#e74c3c;}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:border-color .2s,transform .2s;cursor:pointer;animation:fadeIn .3s ease both;}
.card:hover,.cc:hover,.cmc:hover{border-color:rgba(245,166,35,.4);transform:translateY(-2px);}
.card.feat,.cc.feat,.cmc.feat{border-color:rgba(245,166,35,.22);}
.cprev{height:130px;background:var(--bg3);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;}
.cprev-ico{font-size:40px;opacity:.14;}
.cprev-grad{position:absolute;inset:0;background:linear-gradient(to bottom,transparent 40%,var(--card));}
.cstat{position:absolute;top:12px;right:12px;padding:3px 10px;border-radius:100px;font-size:11px;font-weight:700;font-family:'Space Mono',monospace;}
.s-active{background:rgba(39,174,96,.15);border:1px solid rgba(39,174,96,.4);color:#2ecc71;}
.s-dev{background:rgba(52,152,219,.15);border:1px solid rgba(52,152,219,.4);color:#3498db;}
.s-exp{background:rgba(155,89,182,.15);border:1px solid rgba(155,89,182,.4);color:#9b59b6;}
.s-leg{background:rgba(127,140,141,.15);border:1px solid rgba(127,140,141,.25);color:#7f8c8d;}
.cbody{padding:16px;}
.ctop{display:flex;align-items:flex-start;gap:12px;margin-bottom:10px;}
.cico{width:40px;height:40px;border-radius:10px;background:var(--bg3);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
.cname{font-size:15px;font-weight:800;letter-spacing:-.3px;margin-bottom:2px;}
.ctype{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;}
.cdesc{font-size:13px;color:#999;line-height:1.55;margin-bottom:10px;}
.ctags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:10px;}
.tag{padding:3px 9px;border-radius:100px;font-size:11px;font-weight:700;}
.tl{background:rgba(245,166,35,.1);border:1px solid rgba(245,166,35,.25);color:var(--accent);}
.tc{background:rgba(46,204,113,.1);border:1px solid rgba(46,204,113,.25);color:#2ecc71;}
.tw{background:rgba(52,152,219,.1);border:1px solid rgba(52,152,219,.25);color:#3498db;}
.ts{background:rgba(127,140,141,.1);border:1px solid rgba(127,140,141,.25);color:#95a5a6;}
.to{background:rgba(52,152,219,.08);border:1px solid rgba(52,152,219,.2);color:#5dade2;font-size:10px;}
.cact{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;display:flex;align-items:center;gap:6px;margin-bottom:10px;flex-wrap:wrap;}
.adot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.cftr{display:flex;align-items:center;justify-content:space-between;padding-top:10px;border-top:1px solid var(--border);}
.clnks{display:flex;gap:10px;}
.clnk{color:var(--muted);text-decoration:none;font-size:11px;font-family:'Space Mono',monospace;transition:color .2s;}
.clnk:hover{color:var(--accent);}
.crat{display:flex;align-items:center;gap:4px;font-size:12px;color:var(--muted);}
.stars{color:var(--accent);font-size:11px;}
.cftr-r{display:flex;align-items:center;gap:10px;}
.cc{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:border-color .2s,transform .2s;animation:fadeIn .3s ease both;}
.cc-hdr{padding:20px 18px 14px;display:flex;align-items:flex-start;gap:14px;border-bottom:1px solid var(--border);}
.cc-av{width:52px;height:52px;border-radius:50%;background:var(--bg3);border:2px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;position:relative;}
.cc-ring{position:absolute;inset:-4px;border-radius:50%;border:2px solid rgba(245,166,35,.45);}
.cc-info{flex:1;}
.cc-name{font-size:15px;font-weight:800;margin-bottom:3px;}
.cc-handle{font-size:11px;color:var(--accent);font-family:'Space Mono',monospace;margin-bottom:6px;}
.cc-cat{display:inline-flex;align-items:center;gap:4px;background:var(--bg3);border:1px solid var(--border);border-radius:100px;padding:2px 10px;font-size:11px;color:var(--muted);font-weight:600;}
.cc-bdgs{display:flex;gap:8px;align-items:center;margin-top:5px;}
.cc-body{padding:14px 18px;}
.cc-bio{font-size:13px;color:#999;line-height:1.55;margin-bottom:12px;}
.slbl{font-size:10px;color:var(--muted);font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;}
.cc-sells{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:12px;}
.tsell{background:rgba(245,166,35,.07);border:1px solid rgba(245,166,35,.18);color:#c9922a;font-size:11px;padding:3px 10px;border-radius:100px;font-weight:700;}
.cc-plat{display:flex;gap:5px;flex-wrap:wrap;}
.plat{padding:4px 10px;border-radius:8px;background:var(--bg3);border:1px solid var(--border);font-size:11px;font-weight:700;color:#aaa;}
.cc-ftr{padding:10px 18px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap;}
.clink{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;text-decoration:none;transition:color .2s;}
.clink:hover{color:var(--accent);}
.cmc{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;transition:border-color .2s,transform .2s;animation:fadeIn .3s ease both;}
.cmc-hdr{padding:22px 18px 16px;border-bottom:1px solid var(--border);}
.cmc-flag{font-size:32px;margin-bottom:10px;display:block;}
.cmc-name{font-size:17px;font-weight:800;margin-bottom:4px;}
.cmc-loc{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;margin-bottom:8px;}
.cmc-body{padding:14px 18px;}
.cmc-desc{font-size:13px;color:#999;line-height:1.55;margin-bottom:14px;}
.cmc-meta{display:flex;gap:20px;flex-wrap:wrap;margin-bottom:4px;}
.cmc-ml{font-size:10px;color:var(--muted);font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;}
.cmc-mv{font-size:13px;font-weight:700;}
.cmc-ftr{padding:10px 18px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;gap:8px;}
.cico-img{width:40px;height:40px;border-radius:10px;object-fit:cover;}
.cc-av-img{width:52px;height:52px;border-radius:50%;object-fit:cover;position:absolute;inset:0;}
/* PHASE3: nostrLoadAvatars() bude volana po render() */
.no-res{text-align:center;padding:60px 20px;color:var(--muted);display:none;}
.no-res h3{font-size:18px;margin-bottom:7px;color:var(--text);}
.banner{position:relative;z-index:1;max-width:1200px;margin:0 auto 60px;padding:0 40px;}
.banner-in{background:linear-gradient(135deg,rgba(245,166,35,.07),rgba(255,107,53,.04));border:1px solid rgba(245,166,35,.18);border-radius:16px;padding:26px 34px;display:flex;align-items:center;justify-content:space-between;gap:20px;}
.banner-in h3{font-size:17px;font-weight:800;margin-bottom:4px;}
.banner-in p{font-size:13px;color:var(--muted);}
footer{position:relative;z-index:1;border-top:1px solid var(--border);padding:24px 40px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px;}
.ftr-l{font-size:13px;color:var(--muted);font-family:'Space Mono',monospace;}
.ftr-l a{color:var(--accent);text-decoration:none;}
.ftr-r{display:flex;align-items:center;gap:14px;flex-wrap:wrap;}
.nbadge{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--muted);font-family:'Space Mono',monospace;text-decoration:none;transition:color .2s;}
.nbadge:hover{color:var(--accent);}
.nbdot{width:8px;height:8px;border-radius:50%;background:var(--accent);}
.don{display:flex;align-items:center;gap:7px;background:rgba(245,166,35,.1);border:1px solid rgba(245,166,35,.3);border-radius:8px;padding:7px 14px;cursor:pointer;font-family:'Space Mono',monospace;font-size:12px;color:var(--accent);transition:all .2s;position:relative;}
.don:hover{background:rgba(245,166,35,.18);}
.don-tip{display:none;position:absolute;bottom:calc(100% + 10px);right:0;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:14px;white-space:nowrap;min-width:250px;z-index:200;box-shadow:0 8px 32px rgba(0,0,0,.4);}
.don:hover .don-tip{display:block;}
.don-lbl{font-size:10px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;}
.don-addr{display:flex;align-items:center;justify-content:space-between;gap:10px;background:var(--bg3);border:1px solid var(--border);border-radius:7px;padding:8px 10px;}
.don-addr span{font-size:11px;color:var(--text);}
.cbtn{background:var(--accent);color:#000;border:none;border-radius:5px;padding:3px 8px;font-family:'Space Mono',monospace;font-size:11px;font-weight:700;cursor:pointer;}
.don-sub{font-size:10px;color:var(--muted);margin-top:8px;text-align:center;}
.modal-ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:100;align-items:center;justify-content:center;backdrop-filter:blur(4px);}
.modal-ov.open{display:flex;}
.modal{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:32px;max-width:520px;width:90%;position:relative;max-height:90vh;overflow-y:auto;}
.modal-x{position:absolute;top:14px;right:14px;background:var(--bg3);border:1px solid var(--border);color:var(--muted);width:30px;height:30px;border-radius:7px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;}
.modal h2{font-size:19px;font-weight:800;margin-bottom:4px;}
.modal-sub{font-size:12px;color:var(--muted);margin-bottom:20px;font-family:'Space Mono',monospace;}
.mtabs{display:flex;gap:4px;margin-bottom:20px;background:var(--bg3);border-radius:9px;padding:3px;}
.mtab{flex:1;padding:8px;border:none;background:transparent;color:var(--muted);font-family:'Syne',sans-serif;font-weight:700;font-size:12px;cursor:pointer;border-radius:7px;transition:all .15s;}
.mtab.active{background:var(--accent);color:#000;}
.mform{display:none;}
.mform.active{display:block;}
.fg{margin-bottom:12px;}
.fg label{display:block;font-size:12px;font-weight:600;margin-bottom:4px;color:#ccc;}
.fg input,.fg select,.fg textarea{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:9px 12px;color:var(--text);font-family:'Syne',sans-serif;font-size:13px;outline:none;transition:border-color .2s;}
.fg input:focus,.fg select:focus{border-color:var(--accent);}
.fg select option{background:var(--bg3);}
.frow2{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.pledge{background:rgba(245,166,35,.05);border:1px solid rgba(245,166,35,.15);border-radius:8px;padding:10px 12px;margin-bottom:12px;}
.pledge label{display:flex;gap:10px;align-items:flex-start;cursor:pointer;font-size:12px;color:#aaa;font-weight:400;}
.pledge input{margin-top:2px;accent-color:var(--accent);}
.fsub{width:100%;background:var(--accent);color:#000;border:none;padding:12px;border-radius:10px;font-family:'Syne',sans-serif;font-weight:800;font-size:14px;cursor:pointer;transition:opacity .2s;}
.fsub:hover{opacity:.85;}
.rmod{display:none;position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:200;align-items:center;justify-content:center;backdrop-filter:blur(4px);}
.rmod.open{display:flex;}
.rbox{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:26px;max-width:390px;width:90%;}
.rbox h3{font-size:15px;font-weight:800;margin-bottom:4px;}
.rbox p{font-size:12px;color:var(--muted);margin-bottom:16px;font-family:'Space Mono',monospace;}
.ropts{display:flex;flex-direction:column;gap:7px;margin-bottom:16px;}
.ropt{display:flex;align-items:center;gap:10px;padding:9px 12px;background:var(--bg3);border:1px solid var(--border);border-radius:8px;cursor:pointer;font-size:13px;font-weight:600;transition:border-color .15s;}
.ropt:hover{border-color:rgba(231,76,60,.4);}
.racts{display:flex;gap:10px;}
.rcanc{flex:1;padding:10px;border:1px solid var(--border);background:none;color:var(--muted);font-family:'Syne',sans-serif;font-weight:700;font-size:13px;border-radius:8px;cursor:pointer;}
.rsub{flex:1;padding:10px;border:none;background:#c0392b;color:#fff;font-family:'Syne',sans-serif;font-weight:700;font-size:13px;border-radius:8px;cursor:pointer;}
@media(max-width:680px){header{padding:0 18px;}nav{display:none;}.hero,.filters,.main,.banner,.mode-wrap{padding-left:18px;padding-right:18px;}.grid{grid-template-columns:1fr;}h1{font-size:32px;}.frow2{grid-template-columns:1fr;}}
</style>
</head>
<body>
<header>
  <div class="logo"><div class="logo-icon">&#9889;</div><div class="logo-text">Nostr<span>Market</span></div></div>
  <nav><a href="#">Directory</a><a href="#">About</a><button class="btn" onclick="openModal()">+ Submit</button></nav>
</header>

<section class="hero">
  <div class="hero-tag">&#9889; Built on Nostr &middot; Powered by Lightning</div>
  <h1>Discover<br><em>Nostr</em><br>Marketplaces</h1>
  <p class="hero-sub">The only directory of decentralized marketplace projects, independent creators and local communities on Nostr.</p>
  <div class="stats">
    <div class="stat"><div class="stat-num">9</div><div class="stat-label">Projects</div></div>
    <div class="stat"><div class="stat-num">6</div><div class="stat-label">Creators</div></div>
    <div class="stat"><div class="stat-num">5</div><div class="stat-label">Communities</div></div>
    <div class="stat"><div class="stat-num">100%</div><div class="stat-label">Decentralized</div></div>
  </div>
</section>

<section class="mode-wrap">
  <div class="mode-sw">
    <button class="mbtn active" id="bp" onclick="setMode('p')">Projects <span class="mcnt">9</span></button>
    <button class="mbtn" id="bc" onclick="setMode('c')">Creators <span class="mcnt">6</span></button>
    <button class="mbtn" id="bm" onclick="setMode('m')">Communities <span class="mcnt">5</span></button>
  </div>
</section>

<section class="filters">
  <div class="search"><span>&#128269;</span><input type="text" id="sq" placeholder="Search..." oninput="filterAll()"></div>
  <div class="frow" id="pf">
    <span class="flbl">TYPE:</span>
    <button class="chip active" data-pf="type" data-v="all" onclick="setPF('type','all',this)">All</button>
    <button class="chip" data-pf="type" data-v="p2p" onclick="setPF('type','p2p',this)">P2P</button>
    <button class="chip" data-pf="type" data-v="digital" onclick="setPF('type','digital',this)">Digital</button>
    <button class="chip" data-pf="type" data-v="exchange" onclick="setPF('type','exchange',this)">Exchange</button>
    <div class="divider"></div>
    <span class="flbl">PAY:</span>
    <button class="chip" data-pf="pay" data-v="lightning" onclick="setPF('pay','lightning',this)">&#9889; Lightning</button>
    <button class="chip" data-pf="pay" data-v="cashu" onclick="setPF('pay','cashu',this)">Cashu</button>
    <div class="divider"></div>
    <span class="flbl">STATUS:</span>
    <button class="chip" data-pf="status" data-v="active" onclick="setPF('status','active',this)">Active</button>
    <button class="chip" data-pf="status" data-v="dev" onclick="setPF('status','dev',this)">In Dev</button>
  </div>
  <div class="frow" id="cf" style="display:none">
    <span class="flbl">CATEGORY:</span>
    <button class="chip active" data-cat="all" onclick="setCF('all',this)">All</button>
    <button class="chip" data-cat="art" onclick="setCF('art',this)">Art</button>
    <button class="chip" data-cat="music" onclick="setCF('music',this)">Music</button>
    <button class="chip" data-cat="photo" onclick="setCF('photo',this)">Photography</button>
    <button class="chip" data-cat="craft" onclick="setCF('craft',this)">Crafts</button>
    <button class="chip" data-cat="digital" onclick="setCF('digital',this)">Digital</button>
  </div>
  <div class="frow" id="mf" style="display:none">
    <span class="flbl">REGION:</span>
    <button class="chip active" data-reg="all" onclick="setMF('all',this)">All</button>
    <button class="chip" data-reg="cz" onclick="setMF('cz',this)">&#127464;&#127487; CZ</button>
    <button class="chip" data-reg="sk" onclick="setMF('sk',this)">&#127480;&#127472; SK</button>
    <button class="chip" data-reg="eu" onclick="setMF('eu',this)">&#127466;&#127482; EU</button>
    <button class="chip" data-reg="global" onclick="setMF('global',this)">&#127758; Global</button>
  </div>
</section>

<section class="main">
  <div class="sec-hdr">
    <div class="sec-lbl" id="lbl">Showing all 9 projects</div>
    <select class="sort" onchange="doSort(this.value)">
      <option value="default">Sort: Default</option>
      <option value="name">Name A-Z</option>
      <option value="rating">Top Rated</option>
    </select>
  </div>
  <div class="grid" id="grid"></div>
  <div class="no-res" id="nores"><div style="font-size:40px;margin-bottom:12px">&#128301;</div><h3>Nothing found</h3><p>Try adjusting filters or search.</p></div>
</section>

<section class="banner">
  <div class="banner-in">
    <div><h3>Know a project, creator or community we're missing?</h3><p>Submit to the directory &middot; reviewed within 48h</p></div>
    <button class="btn" onclick="openModal()">+ Submit</button>
  </div>
</section>

<footer>
  <div class="ftr-l">Built for the <a href="https://nostr.com" target="_blank">Nostr</a> community</div>
  <div class="ftr-r">
    <a class="nbadge" href="https://primal.net/p/npub1a2049m2l73ylehvz3kw6uspr7tuld6r2csqqqce8l2seqjnjy8xszr6a8g" target="_blank"><div class="nbdot"></div>Nostr Profile</a>
    <div class="don">&#9889; Donate
      <div class="don-tip">
        <div class="don-lbl">Support this directory</div>
        <div class="don-addr"><span><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bed6d7dadadbd0ccdfd0d9dbcc8a8a8bfed3d7d0d7dcd7cacd90dddfcdd6">[email&#160;protected]</a></span><button class="cbtn" id="cbtn" onclick="doCopy(event)">Copy</button></div>
        <div class="don-sub">Lightning address &middot; Thank you! &#9889;</div>
      </div>
    </div>
  </div>
</footer>

<div class="modal-ov" id="mov" onclick="closeModalOut(event)">
  <div class="modal">
    <button class="modal-x" onclick="closeModal()">&#10005;</button>
    <h2>Submit to Directory</h2>
    <div class="modal-sub">// Fields marked * are required</div>
    <div class="mtabs">
      <button class="mtab active" onclick="switchTab('p',this)">Project</button>
      <button class="mtab" onclick="switchTab('c',this)">Creator</button>
      <button class="mtab" onclick="switchTab('m',this)">Community</button>
    </div>
    <div class="mform active" id="fp">
      <div class="fg"><label>Project Name *</label><input type="text" placeholder="e.g. Shopstr"></div>
      <div class="fg"><label>Website URL *</label><input type="url" placeholder="https://..."></div>
      <div class="fg"><label>Description * (max 120 chars)</label><input type="text" maxlength="120" placeholder="One-liner about the project"></div>
      <div class="frow2">
        <div class="fg"><label>Type *</label><select><option>P2P Marketplace</option><option>Digital Products</option><option>Exchange</option></select></div>
        <div class="fg"><label>Status *</label><select><option>Active</option><option>In Development</option><option>Experimental</option></select></div>
      </div>
      <div class="frow2">
        <div class="fg"><label>Payment</label><select><option>Lightning</option><option>Lightning + Cashu</option></select></div>
        <div class="fg"><label>Open Source</label><select><option>Yes</option><option>No</option></select></div>
      </div>
      <div class="fg"><label>GitHub URL</label><input type="url" placeholder="https://github.com/..."></div>
      <div class="fg"><label>Nostr npub</label><input type="text" placeholder="npub1..."></div>
      <div class="fg"><label>Twitter / X</label><input type="text" placeholder="@handle"></div>
      <div class="pledge"><label><input type="checkbox"> I confirm this listing does not involve illegal goods, weapons, drugs, or harmful content. I take full responsibility.</label></div>
      <button class="fsub">Submit Project &#9889;</button>
    </div>
    <div class="mform" id="fc">
      <div class="fg"><label>Name / Pseudonym *</label><input type="text" placeholder="Your name or alias"></div>
      <div class="fg"><label>Nostr npub *</label><input type="text" placeholder="npub1..."></div>
      <div class="fg"><label>Bio * (max 140 chars)</label><input type="text" maxlength="140" placeholder="What do you create and sell?"></div>
      <div class="frow2">
        <div class="fg"><label>Category *</label><select><option>Art</option><option>Music</option><option>Photography</option><option>Crafts</option><option>Digital</option><option>Writing</option></select></div>
        <div class="fg"><label>Profile Photo URL</label><input type="url" placeholder="https://..."></div>
      </div>
      <div class="fg"><label>What do you sell?</label><input type="text" placeholder="e.g. prints, tracks, templates"></div>
      <div class="fg"><label>Platforms</label><input type="text" placeholder="e.g. Primal, Shopstr, Damus"></div>
      <div class="fg"><label>Twitter / X</label><input type="text" placeholder="@handle"></div>
      <div class="pledge"><label><input type="checkbox"> I confirm my listings will not involve illegal goods, weapons, drugs, or harmful content. I take full responsibility.</label></div>
      <button class="fsub">Submit Creator &#9889;</button>
    </div>
    <div class="mform" id="fm">
      <div class="fg"><label>Community Name *</label><input type="text" placeholder="e.g. Bitcoin Praha"></div>
      <div class="fg"><label>Nostr npub *</label><input type="text" placeholder="npub1..."></div>
      <div class="frow2">
        <div class="fg"><label>City *</label><input type="text" placeholder="e.g. Praha"></div>
        <div class="fg"><label>Country *</label><input type="text" placeholder="e.g. Czech Republic"></div>
      </div>
      <div class="fg"><label>Description *</label><input type="text" maxlength="140" placeholder="What is your community about?"></div>
      <div class="frow2">
        <div class="fg"><label>Region</label><select><option value="cz">Czech</option><option value="sk">Slovak</option><option value="eu">Europe</option><option value="global">Global</option></select></div>
        <div class="fg"><label>Meetup Frequency</label><select><option>Monthly</option><option>Weekly</option><option>Bi-monthly</option><option>Quarterly</option><option>Online only</option></select></div>
      </div>
      <div class="fg"><label>Website</label><input type="url" placeholder="https://..."></div>
      <div class="pledge"><label><input type="checkbox"> I confirm this is a genuine Bitcoin/Nostr community and not spam or commercial promotion.</label></div>
      <button class="fsub">Submit Community &#9889;</button>
    </div>
  </div>
</div>

<div class="rmod" id="rmod">
  <div class="rbox">
    <h3>&#9873; Report listing</h3>
    <p>// Will be reviewed by admin</p>
    <div class="ropts">
      <label class="ropt"><input type="radio" name="rr" value="illegal"> Illegal goods or services</label>
      <label class="ropt"><input type="radio" name="rr" value="weapons"> Weapons or drugs</label>
      <label class="ropt"><input type="radio" name="rr" value="scam"> Scam or fraud</label>
      <label class="ropt"><input type="radio" name="rr" value="spam"> Spam or fake listing</label>
      <label class="ropt"><input type="radio" name="rr" value="other"> Other</label>
    </div>
    <div class="racts">
      <button class="rcanc" onclick="closeReport()">Cancel</button>
      <button class="rsub" onclick="submitReport()">Send Report</button>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
var projects=[
  {id:1,name:"Plebeian Market",npub:"npub1wqfsvk94wqp8a9s9c4pxqglrs4p5hv0qgrg9djkpf42fvrnkuvesu9alev",e:"ðŸª",type:"p2p",tl:"P2P Marketplace",st:"active",desc:"Decentralized P2P marketplace where sellers create stalls and list products. Full e-commerce flow with Lightning payments.",pay:["lightning"],av:["web"],oss:true,url:"https://plebeian.market",gh:"https://github.com/PlebeianTech/plebeian-market",tw:"@PlebeianMarket",npub:"npub1pe6hvepavjxg32pfp7rhu8jl9e2vukgvhajvnj7vs8n3yccqe64qzhgnvh",rat:4.5,act:"Updated recently",v:true,f:true,exp:180},
  {id:2,name:"Shopstr",npub:"npub1yzvxlwp7wawed5vgefwfmugvumtp8c8t0etk3g8sky4n0ndvyxesnxrf8q",e:"ðŸ›ï¸",type:"p2p",tl:"P2P Marketplace",st:"active",desc:"User-friendly marketplace for individual sellers. Accepts Lightning and Cashu ecash. Easy to list and buy.",pay:["lightning","cashu"],av:["web"],oss:true,url:"https://shopstr.store",gh:"https://github.com/shopstr-eng/shopstr",tw:"@shopstrapp",npub:"npub1yzvxlwp7wawed5vgefwfmugvumtp8c8t0etk3g8sky4n0ndvyxesnxrf8q",rat:4.7,act:"Very active",v:true,f:false,exp:145},
  {id:3,name:"ScareSity",e:"ðŸ’Ž",type:"digital",tl:"Digital Products",st:"active",desc:"Platform for limited-edition digital collectibles on Nostr. Focus on scarcity and uniqueness.",pay:["lightning"],av:["web"],oss:false,url:"https://scaresity.com",gh:null,tw:null,npub:null,rat:4.2,act:"Active",v:true,f:false,exp:92},
  {id:4,name:"NostrMarket",e:"ðŸŒ",type:"p2p",tl:"P2P Marketplace",st:"active",desc:"Multi-merchant marketplace aggregating Nostr stalls from relays. Browse products from multiple vendors.",pay:["lightning"],av:["web"],oss:false,url:"https://market.nostr.com",gh:null,tw:null,npub:null,rat:4.0,act:"Active",v:false,f:false,exp:60},
  {id:5,name:"Mostro",npub:"npub1m9cvjmjjwcyq0cz557s4rjd7dhfxkrqe9gscyg6ggnmxkg0vg3mskvxfzz",e:"ðŸ”„",type:"exchange",tl:"P2P Exchange",st:"active",desc:"Non-custodial P2P Bitcoin exchange over Nostr. Trade peer-to-peer without centralized exchange or KYC.",pay:["lightning"],av:["web"],oss:true,url:"https://mostro.network",gh:"https://github.com/MostroP2P/mostro",tw:"@MostroP2P",npub:"npub1mostrop2p00000000000000000000000000000000000000000000000000000",rat:4.6,act:"Very active",v:true,f:true,exp:165},
  {id:6,name:"Civ Kit",e:"ðŸ—ï¸",type:"p2p",tl:"Trade Protocol",st:"dev",desc:"Decentralized global trade infrastructure on Nostr with Lightning escrow and trust mechanisms.",pay:["lightning"],av:["web"],oss:true,url:"https://civkit.africa",gh:"https://github.com/civkit",tw:null,npub:null,rat:3.9,act:"In development",v:false,f:false,exp:110},
  {id:7,name:"FEDSTR",e:"ðŸ¤–",type:"digital",tl:"AI Marketplace",st:"experimental",desc:"Decentralized marketplace for AI/ML datasets using Nostr Data Vending Machines (NIP-90).",pay:["lightning"],av:["web"],oss:false,url:"#",gh:null,tw:null,npub:null,rat:3.5,act:"Experimental",v:false,f:false,exp:25},
  {id:8,name:"LNBits NostrMarket",npub:"npub1gqsggg5k5rjhsn26amkn30zqfx9gkfxay7uyaydmjrr5kqsrfkdqpjnwam",e:"âš™ï¸",type:"p2p",tl:"Self-hosted",st:"active",desc:"Open-source self-hosted marketplace plugin for LNBits. Create your own Nostr stall with full sovereignty.",pay:["lightning"],av:["selfhosted"],oss:true,url:"https://lnbits.com",gh:"https://github.com/lnbits/lnbits",tw:"@lnbits",npub:null,rat:4.3,act:"Actively maintained",v:true,f:false,exp:133},
  {id:9,name:"Nostr Markets",e:"ðŸ”­",type:"p2p",tl:"Aggregator",st:"active",desc:"Tool aggregating NIP-15 stalls and products from Nostr relays. Useful for discovering active sellers.",pay:["lightning"],av:["web"],oss:false,url:"https://nostr-markets.pages.dev",gh:null,tw:null,npub:null,rat:3.8,act:"Active",v:false,f:false,exp:18}
];
var creators=[
  {id:1,name:"Pavel Novak",handle:"npub1pav...3kx",npub:"",npub:"npub1pav...3kx",e:"ðŸŽ¨",cat:"art",cl:"Art",bio:"Czech illustrator selling digital illustrations and limited prints. Inspired by dark surrealism and Bohemian folklore.",sells:["Digital prints","Illustrations","Commissions"],plat:["Primal","Shopstr"],tw:"@paveldraws",rat:4.8,v:true,f:true,exp:155},
  {id:2,name:"Luna Beats",handle:"npub1lun...9mz",npub:"npub1lun...9mz",e:"ðŸŽµ",cat:"music",cl:"Music",bio:"Independent electronic music producer. Selling exclusive tracks, stems and sample packs directly to fans via Nostr.",sells:["Tracks","Stems","Sample packs"],plat:["Damus","Shopstr"],tw:"@lunabeatsmusic",rat:4.5,v:true,f:false,exp:88},
  {id:3,name:"Lenka Foto",handle:"npub1lfot...7pq",npub:"npub1lfot...7pq",e:"ðŸ“·",cat:"photo",cl:"Photography",bio:"Street and documentary photographer from Prague. Selling photo licenses and signed prints worldwide.",sells:["Photo licenses","Signed prints"],plat:["Primal","Plebeian Market"],tw:null,rat:4.6,v:false,f:false,exp:175},
  {id:4,name:"Martin Craft",handle:"npub1mar...2wx",npub:"npub1mar...2wx",e:"ðŸª¡",cat:"craft",cl:"Crafts",bio:"Leather craftsman from Brno. Handmade wallets, bags and accessories. Ships worldwide, Lightning only.",sells:["Wallets","Bags","Custom orders"],plat:["Shopstr","Primal"],tw:"@martincraftshop",rat:4.9,v:true,f:false,exp:42},
  {id:5,name:"PixelWitch",handle:"npub1pix...5st",npub:"npub1pix...5st",e:"ðŸ’»",cat:"digital",cl:"Digital",bio:"UI/UX designer selling icon packs, UI templates and motion loops. Nostr-native since 2023.",sells:["Icon packs","UI templates","Motion loops"],plat:["ScareSity","Shopstr"],tw:"@pixelwitchstudio",rat:4.4,v:false,f:false,exp:120},
  {id:6,name:"Tomas Woodwork",handle:"npub1tom...8yz",npub:"npub1tom...8yz",e:"ðŸªµ",cat:"craft",cl:"Crafts",bio:"Woodworker from Moravia. Custom cutting boards, wooden toys and home decor. Ships within CZ/EU.",sells:["Cutting boards","Wooden toys","Decor"],plat:["Plebeian Market"],tw:null,rat:4.7,v:true,f:false,exp:14}
];
var communities=[
  {id:1,name:"Jednadvacet",flag:"ðŸ‡¨ðŸ‡¿",reg:"cz",city:"Praha (CZ wide)",country:"Czech Republic",desc:"Neformalni sit lokalnich bitcoinovych komunit. Propojuje bitcoinery a pomaha s adopci bitcoinu po cele CR. Pravidlne meetupy ve mestech.",url:"https://jednadvacet.org",npub:"jednadvacet",members:"Multiple local groups",freq:"Monthly per city",v:true,f:true},
  {id:2,name:"Dvadsatjeden",flag:"ðŸ‡¸ðŸ‡°",reg:"sk",city:"Bratislava (SK wide)",country:"Slovakia",desc:"Slovenska siet lokalnych bitcoinovych komunit. Partneri Jednadvacet. Meetupy v mestach po celom Slovensku.",url:"https://dvadsatjeden.org",npub:"dvadsatjeden",members:"Multiple local groups",freq:"Monthly per city",v:true,f:false},
  {id:3,name:"Einundzwanzig",flag:"ðŸ‡©ðŸ‡ª",reg:"eu",city:"Germany wide",country:"Germany",desc:"German Bitcoin community network with local meetups across Germany. Part of the global Twentyone World network.",url:"https://einundzwanzig.space",npub:"einundzwanzig",members:"50+ local groups",freq:"Monthly per city",v:true,f:false},
  {id:4,name:"Twentyone World",flag:"ðŸŒ",reg:"global",city:"Online",country:"Global",desc:"International network of local Bitcoin communities. Coordination hub for Jednadvacet, Dvadsatjeden, Einundzwanzig and more.",url:"https://twentyone.world",npub:"twentyone",members:"Global network",freq:"Ongoing",v:true,f:false},
  {id:5,name:"Nostr Vienna",flag:"ðŸ‡¦ðŸ‡¹",reg:"eu",city:"Vienna",country:"Austria",desc:"Austrian Nostr and Bitcoin community with regular meetups in Vienna. Growing European Nostr scene.",url:"#",npub:"npub1vie...9st",members:"~60 members",freq:"Monthly",v:false,f:false}
];

var mode='p', pfs={type:'all',pay:'all',status:'all'}, cfs={cat:'all'}, mfs={reg:'all'}, sq='';

// â”€â”€ NOSTR AVATAR LOADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Loads profile images from Nostr relays via nostr.band API
// Used in Phase 3 for live data; in prototype shows emoji fallback
var avatarCache = {};

function loadAvatar(npub, imgEl, fallbackEmoji) {
  if (!npub || npub.indexOf('...') > -1) return; // skip placeholder npubs
  if (avatarCache[npub]) {
    applyAvatar(imgEl, avatarCache[npub], fallbackEmoji);
    return;
  }
  fetch('https://api.nostr.band/v0/profiles/' + npub)
    .then(function(r){ return r.json(); })
    .then(function(data){
      var pic = data && data.metadata && data.metadata.picture;
      if (pic) {
        avatarCache[npub] = pic;
        applyAvatar(imgEl, pic, fallbackEmoji);
      }
    })
    .catch(function(){}); // silently fail - shows emoji fallback
}

function applyAvatar(imgEl, url, fallbackEmoji) {
  var img = new Image();
  img.onload = function(){
    imgEl.style.backgroundImage = 'url(' + url + ')';
    imgEl.style.backgroundSize = 'cover';
    imgEl.style.backgroundPosition = 'center';
    imgEl.textContent = '';
  };
  img.onerror = function(){}; // keep emoji fallback
  img.src = url;
}
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function sCls(s){return{active:'s-active',dev:'s-dev',experimental:'s-exp',legacy:'s-leg'}[s]||'s-active';}
function sLbl(s){return{active:'Active',dev:'In Dev',experimental:'Experimental',legacy:'Legacy'}[s]||s;}
function strs(r){var f=Math.floor(r),h=r%1>=.5?1:0;return'â˜…'.repeat(f)+(h?'Â½':'')+'â˜†'.repeat(5-f-h);}
function exp(d){if(d>30)return '<span class="exp">&#128336; '+d+'d left</span>';return '<span class="exp soon">&#9888; '+d+'d left</span>';}
function bdg(item){var b='';if(item.f)b+='<span class="badge-f">&#9733; Featured</span>';if(item.v)b+='<span class="badge-v">&#10003; Verified</span>';return b?'<div class="bdgs">'+b+'</div>':'';}
function payT(x){return{lightning:'<span class="tag tl">&#9889; Lightning</span>',cashu:'<span class="tag tc">Cashu</span>'}[x]||'';}
function avT(x){return{web:'<span class="tag tw">&#127760; Web</span>',selfhosted:'<span class="tag ts">Self-hosted</span>'}[x]||'';}
function rptBtn(name){
  return '<button class="rpt" onclick="event.stopPropagation();openReport(this)" data-name="'+name.replace(/"/g,'&quot;')+'">&#9873; Report</button>';
}

function renderP(p){
  var gh=p.gh?'<a class="clnk" href="'+p.gh+'" target="_blank" onclick="event.stopPropagation()">&#9015; GitHub</a>':'';
  var tw=p.tw?'<a class="clnk" href="https://twitter.com/'+p.tw.replace('@','')+'" target="_blank" onclick="event.stopPropagation()">X '+p.tw+'</a>':'';
  var dc={active:'#2ecc71',dev:'#3498db',experimental:'#9b59b6',legacy:'#7f8c8d'}[p.st]||'#2ecc71';
  var div=document.createElement('div');
  div.className='card'+(p.f?' feat':'');
  div.dataset.url=p.url;
  if(p.npub) div.dataset.npub=p.npub;
  /* PHASE3: zde bude nostrLoadAvatars() nastavovat src z Nostr kind:0 profilu */
  var logoHtml='<div class="cico" data-npub="'+(p.npub||'')+'">'+p.e+'</div>';
  div.innerHTML=
    '<div class="cprev"><div class="cprev-ico">'+p.e+'</div><div class="cprev-grad"></div>'
    +'<div class="cstat '+sCls(p.st)+'">'+sLbl(p.st)+'</div></div>'
    +'<div class="cbody">'+bdg(p)
    +'<div class="ctop">'+logoHtml+'<div><div class="cname">'+p.name+'</div><div class="ctype">'+p.tl+'</div></div></div>'
    +'<div class="cdesc">'+p.desc+'</div>'
    +'<div class="ctags">'+p.pay.map(payT).join('')+p.av.map(avT).join('')+(p.oss?'<span class="tag to">OSS</span>':'')+'</div>'
    +'<div class="cact"><div class="adot" style="background:'+dc+'"></div>'+p.act+'&nbsp;&nbsp;'+exp(p.exp)+'</div>'
    +'<div class="cftr"><div class="clnks"><a class="clnk" href="'+p.url+'" target="_blank" onclick="event.stopPropagation()">&#128279; Visit</a>'+gh+tw+'</div>'
    +'<div class="cftr-r"><div class="crat"><span class="stars">'+strs(p.rat)+'</span> '+p.rat+'</div>'
    +'<button class="rpt" data-name="'+p.name.replace(/"/g,'&quot;')+'">&#9873; Report</button>'
    +'</div></div></div>';
  div.addEventListener('click', function(e){
    if(e.target.tagName!=='A'&&e.target.tagName!=='BUTTON'){window.open(this.dataset.url,'_blank');}
  });
  div.querySelector('.rpt').addEventListener('click',function(e){
    e.stopPropagation();openReport(this.dataset.name);
  });
  if(p.npub){
    var ico = div.querySelector('.cprev-ico');
    if(ico) loadAvatar(p.npub, ico, p.e);
  }
  return div;
}

function renderC(c){
  var sells=c.sells.map(function(s){return'<span class="tsell">'+s+'</span>';}).join('');
  var plats=c.plat.map(function(p){return'<div class="plat">'+p+'</div>';}).join('');
  var tw=c.tw?'<a class="clink" href="https://twitter.com/'+c.tw.replace('@','')+'" target="_blank">X '+c.tw+'</a>':'';
  var b='';if(c.f)b+='<span class="badge-f">&#9733; Featured</span>';if(c.v)b+='<span class="badge-v">&#10003; Verified</span>';
  var div=document.createElement('div');
  div.className='cc'+(c.f?' feat':'');
  if(c.npub) div.dataset.npub=c.npub;
  /* PHASE3: zde bude nostrLoadAvatars() nastavovat src avataru z Nostr kind:0 profilu */
  var avHtml='<div class="cc-av" data-npub="'+(c.npub||'')+'">'+c.e+'<div class="cc-ring"></div></div>';
  div.innerHTML=
    '<div class="cc-hdr"><div class="cc-av">'+avHtml+'<div class="cc-ring"></div></div>'
    +'<div class="cc-info"><div class="cc-name">'+c.name+'</div>'
    +'<div class="cc-handle">&#9889; '+c.handle+'</div>'
    +'<div class="cc-cat">'+c.e+' '+c.cl+'</div>'
    +(b?'<div class="cc-bdgs">'+b+'</div>':'')+'</div></div>'
    +'<div class="cc-body"><div class="cc-bio">'+c.bio+'</div>'
    +'<div class="slbl">Sells</div><div class="cc-sells">'+sells+'</div>'
    +'<div class="slbl">Active on</div><div class="cc-plat">'+plats+'</div></div>'
    +'<div class="cc-ftr"><a class="clink" href="#">&#128995; Nostr profile</a>'
    +'<div style="display:flex;align-items:center;gap:8px;">'+tw+exp(c.exp)
    +'<button class="rpt" data-name="'+c.name.replace(/"/g,'&quot;')+'">&#9873; Report</button>'
    +'</div><div class="crat"><span class="stars">'+strs(c.rat)+'</span> '+c.rat+'</div></div>';
  div.querySelector('.rpt').addEventListener('click',function(e){
    e.stopPropagation();openReport(this.dataset.name);
  });
  if(c.npub){
    var av = div.querySelector('.cc-av');
    if(av) loadAvatar(c.npub, av, c.e);
  }
  return div;
}

function renderM(m){
  var b='';if(m.f)b+='<span class="badge-f">&#9733; Featured</span>';if(m.v)b+='<span class="badge-v">&#10003; Verified</span>';
  var div=document.createElement('div');
  div.className='cmc'+(m.f?' feat':'');
  div.innerHTML=
    '<div class="cmc-hdr"><span class="cmc-flag">'+m.flag+'</span>'
    +'<div class="cmc-name">'+m.name+'</div>'
    +'<div class="cmc-loc">&#128205; '+m.city+', '+m.country+'</div>'
    +(b?'<div class="bdgs">'+b+'</div>':'')+'</div>'
    +'<div class="cmc-body"><div class="cmc-desc">'+m.desc+'</div>'
    +'<div class="cmc-meta">'
    +'<div><div class="cmc-ml">Members</div><div class="cmc-mv">'+m.members+'</div></div>'
    +'<div><div class="cmc-ml">Meetups</div><div class="cmc-mv">'+m.freq+'</div></div>'
    +'</div></div>'
    +'<div class="cmc-ftr"><a class="clink" href="'+m.url+'" target="_blank">&#127760; Website</a>'
    +'<button class="rpt" data-name="'+m.name.replace(/"/g,'&quot;')+'">&#9873; Report</button></div>';
  div.querySelector('.rpt').addEventListener('click',function(){openReport(this.dataset.name);});
  return div;
}

function render(){
  var grid=document.getElementById('grid');
  var nores=document.getElementById('nores');
  var lbl=document.getElementById('lbl');
  var items,html_fn,all;
  var s=sq;
  if(mode==='p'){
    items=projects.filter(function(p){
      return(pfs.type==='all'||p.type===pfs.type)
        &&(pfs.pay==='all'||p.pay.indexOf(pfs.pay)>-1)
        &&(pfs.status==='all'||p.st===pfs.status)
        &&(!s||p.name.toLowerCase().indexOf(s)>-1||p.desc.toLowerCase().indexOf(s)>-1);
    });
    all=projects.length;
    html_fn=renderP;
    lbl.textContent='Showing '+(items.length===all?'all ':items.length+' of ')+all+' projects';
  }else if(mode==='c'){
    items=creators.filter(function(c){
      return(cfs.cat==='all'||c.cat===cfs.cat)
        &&(!s||c.name.toLowerCase().indexOf(s)>-1||c.bio.toLowerCase().indexOf(s)>-1);
    });
    all=creators.length;
    html_fn=renderC;
    lbl.textContent='Showing '+(items.length===all?'all ':items.length+' of ')+all+' creators';
  }else{
    items=communities.filter(function(m){
      return(mfs.reg==='all'||m.reg===mfs.reg)
        &&(!s||m.name.toLowerCase().indexOf(s)>-1||m.city.toLowerCase().indexOf(s)>-1||m.desc.toLowerCase().indexOf(s)>-1);
    });
    all=communities.length;
    html_fn=renderM;
    lbl.textContent='Showing '+(items.length===all?'all ':items.length+' of ')+all+' communities';
  }
  if(!items.length){grid.innerHTML='';nores.style.display='block';return;}
  nores.style.display='none';
  grid.innerHTML='';
  items.forEach(function(item){grid.appendChild(html_fn(item));});

}

function setMode(m){
  mode=m;
  ['p','c','m'].forEach(function(x){document.getElementById('b'+x).classList.toggle('active',x===m);});
  document.getElementById('pf').style.display=m==='p'?'flex':'none';
  document.getElementById('cf').style.display=m==='c'?'flex':'none';
  document.getElementById('mf').style.display=m==='m'?'flex':'none';
  document.getElementById('sq').value='';sq='';
  render();
}

function setPF(type,val,el){
  if(pfs[type]===val&&val!=='all'){pfs[type]='all';document.querySelectorAll('[data-pf="'+type+'"][data-v="all"]').forEach(function(b){b.classList.add('active');});el.classList.remove('active');}
  else{pfs[type]=val;document.querySelectorAll('[data-pf="'+type+'"]').forEach(function(b){b.classList.remove('active');});el.classList.add('active');}
  render();
}
function setCF(val,el){cfs.cat=val;document.querySelectorAll('[data-cat]').forEach(function(b){b.classList.remove('active');});el.classList.add('active');render();}
function setMF(val,el){mfs.reg=val;document.querySelectorAll('[data-reg]').forEach(function(b){b.classList.remove('active');});el.classList.add('active');render();}
function filterAll(){sq=document.getElementById('sq').value.toLowerCase().trim();render();}
function doSort(v){
  if(mode==='p'){if(v==='name')projects.sort(function(a,b){return a.name.localeCompare(b.name);});else if(v==='rating')projects.sort(function(a,b){return b.rat-a.rat;});else projects.sort(function(a,b){return a.id-b.id;});}
  else if(mode==='c'){if(v==='name')creators.sort(function(a,b){return a.name.localeCompare(b.name);});else if(v==='rating')creators.sort(function(a,b){return b.rat-a.rat;});else creators.sort(function(a,b){return a.id-b.id;});}
  render();
}

function openModal(){document.getElementById('mov').classList.add('open');document.body.style.overflow='hidden';}
function closeModal(){document.getElementById('mov').classList.remove('open');document.body.style.overflow='';}
function closeModalOut(e){if(e.target===document.getElementById('mov'))closeModal();}
function switchTab(t,el){
  document.querySelectorAll('.mtab').forEach(function(x){x.classList.remove('active');});el.classList.add('active');
  ['p','c','m'].forEach(function(x){document.getElementById('f'+x).classList.toggle('active',x===t);});
}

function openReport(el){
  var name = typeof el === 'string' ? el : el.dataset.name;
  document.getElementById('rmod').dataset.t=name;
  document.getElementById('rmod').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeReport(){document.getElementById('rmod').classList.remove('open');document.body.style.overflow='';document.querySelectorAll('input[name="rr"]').forEach(function(r){r.checked=false;});}
function submitReport(){
  if(!document.querySelector('input[name="rr"]:checked')){alert('Please select a reason.');return;}
  closeReport();
  var msg=document.createElement('div');
  msg.style.cssText='position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:#1a1a1a;border:1px solid #333;color:#e8e8e8;padding:12px 22px;border-radius:10px;font-family:Space Mono,monospace;font-size:13px;z-index:999;';
  msg.textContent='Report submitted. Thank you.';
  document.body.appendChild(msg);
  setTimeout(function(){msg.remove();},3000);
}

function doCopy(e){
  e.stopPropagation();
  navigator.clipboard.writeText('hiddenranger445@minibits.cash').then(function(){
    var b=document.getElementById('cbtn');b.textContent='Copied!';
    setTimeout(function(){b.textContent='Copy';},2000);
  });
}

render();

/* ============================================================
   PHASE 3 - NOSTR AVATAR LOADER
   Tato funkce bude v Fazi 3 nahrazena skutecnym volanim
   Nostr relay API (NIP-01 kind:0 profil event).
   
   Postup:
   1. Najdi vsechny elementy s data-npub atributem
   2. Pro kazdy npub zavolej: GET https://api.nostr.band/v0/profiles/{npub}
   3. Z odpovedi ziskej picture URL z content.picture
   4. Nastav img.src = picture_url
   
   Priklad volani (Faze 3):
   async function nostrLoadAvatars() {
     document.querySelectorAll('[data-npub]').forEach(async function(img) {
       const npub = img.dataset.npub;
       if (!npub || npub.includes('...')) return;
       const res = await fetch('https://api.nostr.band/v0/profiles/' + npub);
       const data = await res.json();
       const pic = data?.profile?.content?.picture;
       if (pic) img.src = pic;
     });
   }
   ============================================================ */
function nostrLoadAvatars() {
  /* STUB - bude implementovano v Fazi 3 */
}
</script>
</body>
</html>  
